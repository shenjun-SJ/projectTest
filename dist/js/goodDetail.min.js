"use strict";function _classCallCheck(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,s){for(var e=0;e<s.length;e++){var n=s[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,s,e){return s&&_defineProperties(t.prototype,s),e&&_defineProperties(t,e),t}var Details=function(){function t(){_classCallCheck(this,t),this.cont=document.querySelector(".cont"),this.url="http://localhost/projectTest/dist/libs/data/goodsList.json",this.load(),this.getId()}return _createClass(t,[{key:"getId",value:function(){this.id=location.search.slice(1).split("=")[1]}},{key:"load",value:function(){var s=this;$.getJSON(this.url,function(t){s.display(t),s.data=t})}},{key:"display",value:function(t){var s=this;t.forEach(function(t){t.goodId===s.id&&(s.cont.innerHTML='\n                <div class="magnifier">\n                    <div class="s_box">\n                        <img src="'.concat(t.imgs.largeImg[0],'" alt="">\n                        <span></span>\n                        <p class="mask"></p>\n                    </div>\n                    <div class="b_box">\n                        <img src="').concat(t.imgs.largeImg[0],'" alt="">\n                    </div>\n                    <span class="clear"></span>\n                    <ul class="sList">\n                        ').concat(s.createLi(t.imgs.smallImg),'\n                    </ul>\n                </div>\n                <div class="goodsMsg">\n                    <p class="brand">').concat(t.brand,"</p>\n                    <h3>").concat(t.title,"</h3>\n                    <p>￥").concat(t.price,'</p>\n                    <p>价格已包含税费，无需另付税费</p>\n                    <div class="content">净含量\n                        <select>').concat(t.content,"\n                            <option>").concat(t.content,'</option>\n                        </select>\n                    </div>\n                    <p class="address">送达<i>免运费</i><span>2 - 5 天 配送自 ').concat(t.country[0],'  </span></p>\n                    <p class="num">数量<span class="iconfont icon-jian"></span><strong>1</strong><span class="iconfont icon-jia"></p>\n                    <p class="sum">总价<span>￥').concat(t.price,'</span></p>\n                    <div>\n                        <em class="intocar">加入购物车</em>\n                        <a href="http://localhost/projectTest/dist/pages/shoppingCart.html"><em class="buy">立即购买</em></a>\n                    </div>\n                </div>'),new Large(t.imgs),s.addEvent())})}},{key:"createLi",value:function(t){for(var s="",e=0;e<t.length;e++)s+='<li><img src="'.concat(t[e],'" alt=""></li>');return s}},{key:"addEvent",value:function(){var e=this;this.cont.onclick=function(t){var s=t||window.event;"intocar"===(s.target||s.srcElement).className&&(e.goodId=e.id,e.setData())}}},{key:"setData",value:function(){var t=localStorage.getItem("goodsMsg");if(null===t)t=[{goodId:this.goodId,num:1,msg:this.getData(this.goodId)}];else{t=JSON.parse(t);for(var s=0,e=0;e<t.length;e++)if(t[e].goodId===this.goodId){t[e].num++,s=1;break}0==s&&t.push({goodId:this.goodId,num:1,msg:this.getData(this.goodId)})}localStorage.setItem("goodsMsg",JSON.stringify(t))}},{key:"getData",value:function(t){for(var s=0;s<this.data.length;s++)if(this.data[s].goodId===t)return this.data[s];return{}}}]),t}(),d=new Details,Large=function(){function s(t){_classCallCheck(this,s),this.sBox=document.querySelector(".s_box"),this.sImg=document.querySelector(".s_box img"),this.sSpan=document.querySelector(".s_box span"),this.bBox=document.querySelector(".b_box"),this.bImg=document.querySelector(".b_box img"),this.li=document.querySelectorAll(".sList li"),this.imgData=t,this.addEvent()}return _createClass(s,[{key:"addEvent",value:function(){var s=this,e=this;this.sBox.onmouseover=function(){e.over()},this.sBox.onmousemove=function(t){var s=t||window.event;e.move(s)},this.sBox.onmouseout=function(){e.out()};for(var t=0;t<this.li.length;t++)!function(t){s.li[t].onclick=function(){e.sImg.src=e.imgData.largeImg[t],e.bImg.src=e.imgData.largeImg[t]}}(t)}},{key:"over",value:function(){this.sSpan.style.display="block",this.bBox.style.display="block"}},{key:"move",value:function(t){var s=t.offsetX-this.sSpan.offsetWidth/2,e=t.offsetY-this.sSpan.offsetHeight/2;s<0&&(s=0),e<0&&(e=0),s>this.sBox.offsetWidth-this.sSpan.offsetWidth&&(s=this.sBox.offsetWidth-this.sSpan.offsetWidth),e>this.sBox.offsetHeight-this.sSpan.offsetHeight&&(e=this.sBox.offsetHeight-this.sSpan.offsetHeight),this.sSpan.style.left=s+"px",this.sSpan.style.top=e+"px";var n=s/(this.sBox.offsetWidth-this.sSpan.offsetWidth),o=e/(this.sBox.offsetHeight-this.sSpan.offsetHeight);this.bImg.style.left=(this.bBox.offsetWidth-this.bImg.offsetWidth)*n+"px",this.bImg.style.top=(this.bBox.offsetHeight-this.bImg.offsetHeight)*o+"px"}},{key:"out",value:function(){this.sSpan.style.display="none",this.bBox.style.display="none"}}]),s}();